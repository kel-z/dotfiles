#!/bin/bash
LOCK_FILE="$HOME/.rotation_lock"

if [ -f "$LOCK_FILE" ]; then
    rm "$LOCK_FILE"
    echo "Rotation unlocked"
else
    CURRENT=$(swaymsg -t get_outputs | python3 -c "import sys, json; print(json.load(sys.stdin)[0]['transform'])")
    echo "$CURRENT" > "$LOCK_FILE"
    echo "Rotation locked at transform: $CURRENT"
fi

pkill -SIGRTMIN+8 waybar
